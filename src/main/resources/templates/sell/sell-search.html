<!DOCTYPE html>
<html
  lang="pt"
  xmlns="http://www.w3.org/1999/xhtml"
  xmlns:th="http://www.thymeleaf.org"
  xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
  layout:decorate="~{layout/layout}"
>
  <head>
    <title>::Brewer - Pesquisa de vendas</title>
  </head>

  <body>
    <section layout:fragment="conteudo">
      <div class="page-header">
        <div class="container-fluid">
          <div class="row">
            <div class="col-xs-10">
              <h1>Pesquisa de vendas</h1>
            </div>

            <div class="col-xs-2">
              <div class="aw-page-header-controls">
                <a class="btn btn-default" th:href="@{/vendas/nova}">
                  <i class="glyphicon glyphicon-plus-sign"></i>
                  <span class="hidden-xs hidden-sm">Nova venda</span>
                </a>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="container-fluid">
        <form method="GET" th:object="${vendaFilter}" th:action="@{/vendas}">
          <div class="row">
            <div class="form-group col-sm-6">
              <label class="control-label" for="codigo">Código</label>
              <input
                type="text"
                class="form-control"
                id="codigo"
                autofocus="autofocus"
                th:field="*{codigo}"
              />
            </div>

            <div class="form-group col-sm-6">
              <label for="status" class="control-label">Status</label>
              <select id="status" class="form-control" th:field="*{status}">
                <option value="" selected>Todos os estilos</option>
                <option
                  th:each="status : ${statusVendaValues}"
                  th:value="${status.codigo}"
                  th:text="${status.nome}"
                ></option>
              </select>
            </div>
          </div>

          <div class="row">
            <div class="form-group col-sm-6">
              <label for="dataCriacaoInicial">Data de criação</label>
              <div class="form-inline">
                <input
                  type="text"
                  class="form-control aw-form-control-inline-sm js-date"
                  id="dataCriacaoInicial"
                  th:field="*{desde}"
                  autocomplete="off"
                />
                <label for="dataCriacaoFinal" class="aw-form-label-between"
                  >até</label
                >
                <input
                  type="text"
                  class="form-control aw-form-control-inline-sm js-date"
                  id="dataCriacaoInicial"
                  th:field="*{ate}"
                  autocomplete="off"
                />
              </div>
            </div>

            <div class="form-group col-sm-6">
              <label for="valorMinimo">Valor total</label>
              <div class="form-inline">
                <input
                  type="text"
                  class="form-control aw-form-control-inline-sm js-decimal"
                  id="valorMinimo"
                  th:field="*{valorMinimo}"
                />
                <label for="valorMaximo" class="aw-form-label-between"
                  >até</label
                >
                <input
                  type="text"
                  class="form-control aw-form-control-inline-sm js-decimal"
                  id="valorMaximo"
                  th:field="*{valorMaximo}"
                />
              </div>
            </div>
          </div>

          <div class="row">
            <div class="form-group col-sm-6">
              <label class="control-label" for="nomeCliente"
                >Nome cliente</label
              >
              <input
                type="text"
                class="form-control"
                id="nomeCliente"
                th:field="*{nomeCliente}"
              />
            </div>

            <div class="form-group col-sm-6">
              <label for="cpfOuCnpj" class="control-label">CPF/CNPJ</label>
              <input
                type="text"
                class="form-control"
                id="cpfOuCnpj"
                th:field="*{cpfOuCnpjCliente}"
              />
            </div>
          </div>

          <button type="submit" class="btn btn-primary">Pesquisar</button>
        </form>

        <div class="table-responsive bw-tabela-simples">
          <table class="table table-hover">
            <thead>
              <tr>
                <th>Código</th>
                <th>
                  <th:block
                    th:replace="layout/fragments/ordered-table :: ordered-table(${wrapperPage}, 'cliente', 'Cliente')"
                  ></th:block>
                </th>
                <th>
                  <th:block
                    th:replace="layout/fragments/ordered-table :: ordered-table(${wrapperPage}, 'dataCriacao', 'Data de Criação')"
                  ></th:block>
                </th>
                <th>
                  <th:block
                    th:replace="layout/fragments/ordered-table :: ordered-table(${wrapperPage}, 'valorTotal', 'Valor Total')"
                  ></th:block>
                </th>
                <th>
                  <th:block
                    th:replace="layout/fragments/ordered-table :: ordered-table(${wrapperPage}, 'vendedor', 'Vendedor')"
                  ></th:block>
                </th>
                <th>
                  <th:block
                    th:replace="layout/fragments/ordered-table :: ordered-table(${wrapperPage}, 'status', 'Status')"
                  ></th:block>
                </th>
                <th class="table-col-acoes"></th>
              </tr>
            </thead>

            <tbody>
              <tr th:each="venda : ${pagina.conteudo}">
                <td th:text="${venda.codigo}"></td>
                <td th:text="${venda.cliente.nome}"></td>
                <td th:text="${{venda.dataCriacao}}"></td>
                <td th:text="|R$ ${{venda.valorTotal}}|"></td>
                <td th:text="${venda.usuario.nome}"></td>
                <td th:text="${venda.status.descricao}"></td>
                <td class="text-center">
                  <a
                    class="btn btn-link btn-xs js-tooltip"
                    title="Editar"
                    href="#"
                  >
                    <i class="glyphicon glyphicon-pencil"></i>
                  </a>
                </td>
              </tr>
            </tbody>
          </table>

          <tr th:if="${wrapperPage.page.content.isEmpty()}">
            Não há itens a serem carregados
          </tr>
        </div>
        <div
          class="col-sm-12 text-center"
          th:if="${not wrapperPage.page.content.isEmpty()}"
        >
          <ul
            class="pagination pagination-sm"
            th:with="curretPage=${wrapperPage.getPage().number}"
          >
            <li th:classappend="${wrapperPage.page.isFirst()} ? disabled">
              <a
                th:href="${wrapperPage.urlResolverTo(curretPage - 1)}"
                th:remove="${wrapperPage.page.isFirst()} ? tag"
              >
                <span>&laquo;</span>
              </a>
            </li>

            <th:block
              th:each="p : ${#numbers.sequence(1, wrapperPage.page.totalPages)}"
              th:with="pageNumber=${p - 1}"
            >
              <li th:classappend="${pageNumber == curretPage} ? active">
                <a th:href="${wrapperPage.urlResolverTo(pageNumber)}"
                  >[[${p}]]</a
                >
              </li>
            </th:block>
            <th:block th:if="${wrapperPage.page.totalPages} == 1">
              <li>
                <a th:href="${wrapperPage.urlResolverTo(1)}">2</a>
              </li>
            </th:block>

            <li th:classappend="${wrapperPage.page.isLast()} ? disable">
              <a
                th:href="${wrapperPage.urlResolverTo(curretPage + 1)}"
                th:remove="${wrapperPage.page.isLast()} ? tag"
              >
                <span>&raquo;</span>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </section>
  </body>
</html>
